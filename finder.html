<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Glam Guide â€“ Finder</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
<div class="container-fluid">
<a class="navbar-brand" href="#">Glam Guide</a>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
<li class="nav-item"><a class="nav-link active" href="finder.html">Finder</a></li>
<li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
</ul>
</div>
</nav>

<main class="container my-5">
<h2>Find Makeup Products</h2>
<form id="searchForm" class="row g-3 mb-4">
<div class="col-md-6">
<label for="brandSelect">Brand</label>
<select id="brandSelect" class="form-select">
<option value="maybelline">Maybelline</option>
<option value="covergirl">Covergirl</option>
<option value="l'oreal">L'Oreal</option>
</select>
</div>
<div class="col-md-6">
<label for="typeSelect">Product Type</label>
<select id="typeSelect" class="form-select">
<option value="lipstick">Lipstick</option>
<option value="foundation">Foundation</option>
<option value="eyeliner">Eyeliner</option>
</select>
</div>
<div class="col-12">
<button type="submit" class="btn btn-primary">Search</button>
</div>
</form>

<div id="spinner" class="text-center my-3">
<div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div>
</div>

<div id="productResults" class="row"></div>

<hr class="my-5"/>
<h3>Submit Your Suggestions</h3>
<form id="suggestionForm" class="row g-3 needs-validation" novalidate>
<div class="col-md-6">
<input type="text" class="form-control" placeholder="Your Name" id="userName" required>
<div class="invalid-feedback">Name required.</div>
</div>
<div class="col-md-6">
<input type="email" class="form-control" placeholder="Email" id="email" required>
<div class="invalid-feedback">Valid email required.</div>
</div>
<div class="col-md-6">
<select class="form-select" id="skinType" required title="Select your skin type">
<option value="">Skin Type...</option>
<option value="oily">Oily</option>
<option value="dry">Dry</option>
</select>
<div class="invalid-feedback">Select skin type.</div>
</div>
<div class="col-md-6">
<label>Finish:</label>
<div>
<input class="form-check-input" type="radio" name="finish" value="Matte" required title="Select Matte finish"> Matte
<input class="form-check-input" type="radio" name="finish" value="Dewy" title="Select Dewy finish"> Dewy
</div>
</div>
<div class="col-12">
<input class="form-check-input" type="checkbox" id="agree" required title="You must agree to continue"> I agree
<div class="invalid-feedback">You must agree.</div>
</div>
<div class="col-12">
<button class="btn btn-success" type="submit">Submit</button>
</div>
</form>

<table class="table mt-4 table-striped">
<thead><tr><th>Name</th><th>Email</th><th>Skin</th><th>Finish</th></tr></thead>
<tbody id="suggestionTable"></tbody>
</table>
</main>

<script>
document.getElementById("searchForm").addEventListener("submit", async function (e) {
e.preventDefault();
const brand = document.getElementById("brandSelect").value;
const type = document.getElementById("typeSelect").value;
const container = document.getElementById("productResults");
const spinner = document.getElementById("spinner");
container.innerHTML = "";
spinner.style.display = "block";

try {
const res = await axios.get("http://makeup-api.herokuapp.com/api/v1/products.json", {
params: { brand, product_type: type }
});
const products = res.data.slice(0, 8);
products.forEach(p => {
container.innerHTML += `
<div class="col-md-3">
<div class="card mb-3">
<img src="${p.image_link}" class="card-img-top" alt="${p.name}">
<div class="card-body">
<h5>${p.name}</h5>
<p>${p.description?.substring(0, 80) || 'No description'}</p>
<span class="badge bg-secondary">${p.price}$</span>
</div>
</div>
</div>`;
});
} catch {
alert("Failed to load data.");
} finally {
spinner.style.display = "none";
}
});

(() => {
const forms = document.querySelectorAll('.needs-validation');
Array.from(forms).forEach(form =>
form.addEventListener('submit', event => {
if (!form.checkValidity()) {
event.preventDefault();
event.stopPropagation();
}
form.classList.add('was-validated');
}, false)
);
})();

document.getElementById("suggestionForm").addEventListener("submit", function (e) {
e.preventDefault();
const name = document.getElementById("userName").value;
const email = document.getElementById("email").value;
const skin = document.getElementById("skinType").value;
const finish = document.querySelector('input[name="finish"]:checked').value;

const row = document.createElement("tr");
row.innerHTML = `<td>${name}</td><td>${email}</td><td>${skin}</td><td>${finish}</td>`;
document.getElementById("suggestionTable").appendChild(row);

this.reset();
this.classList.remove("was-validated");
});
</script>
</body>
</html>

